<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sara Wellness | Profile</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="./style.css">

  <style>
    body {
      background: linear-gradient(135deg, rgba(46, 139, 87, 0.08), rgba(255, 255, 255, 1));
      min-height: 100vh;
    }

    .wrap {
      padding: 36px 0 70px;
    }

    .grid {
      display: grid;
      grid-template-columns: 1.1fr 1fr;
      gap: 18px;
    }

    @media (max-width: 980px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }

    .card {
      background: #fff;
      border-radius: 16px;
      padding: 18px;
      border: 1px solid rgba(0, 0, 0, 0.06);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.08);
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(46, 139, 87, 0.10);
      color: #1e6a42;
      font-weight: 800;
      font-size: 13px;
    }

    .user-meta {
      display: grid;
      gap: 10px;
      margin-top: 10px;
    }

    .meta-row {
      display: flex;
      gap: 10px;
      align-items: flex-start;
    }

    .meta-icon {
      width: 34px;
      height: 34px;
      border-radius: 10px;
      display: grid;
      place-items: center;
      background: rgba(0, 0, 0, 0.04);
      color: #333;
      flex: 0 0 auto;
    }

    .meta-row strong {
      display: block;
      font-size: 13px;
      color: #666;
      margin-bottom: 2px;
    }

    .meta-row span {
      color: #222;
      font-weight: 700;
    }

    .actions {
      margin-top: 14px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
    }

    .btn-outline {
      background: transparent;
      border: 1px solid rgba(46, 139, 87, 0.6);
      color: #2E8B57;
    }

    .small {
      color: #666;
      font-size: 13px;
      line-height: 1.5;
      margin-top: 8px;
    }

    /* ===== My Testimonials ===== */
    .manager-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 14px;
    }

    @media (max-width: 1100px) {
      .manager-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 700px) {
      .manager-grid {
        grid-template-columns: 1fr;
      }
    }

    .manager-card {
      border: 1px solid rgba(0, 0, 0, 0.06);
      border-radius: 14px;
      overflow: hidden;
      background: #fff;
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.06);
    }

    .manager-img {
      height: 120px;
      background: rgba(46, 139, 87, 0.06);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .manager-img img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .manager-body {
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .pill {
      font-size: 11px;
      font-weight: 900;
      padding: 5px 9px;
      border-radius: 999px;
      background: rgba(46, 139, 87, 0.10);
      color: #1e6a42;
    }

    .pill.pending {
      background: rgba(255, 193, 7, 0.18);
      color: #a06a00;
    }

    .truncate-3 {
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .alert {
      display: none;
      margin-top: 12px;
      padding: 12px;
      border-radius: 12px;
      font-size: 14px;
      border: 1px solid transparent;
      line-height: 1.4;
    }

    .alert.success {
      display: block;
      background: rgba(46, 139, 87, 0.10);
      border-color: rgba(46, 139, 87, 0.30);
      color: #1e6a42;
    }

    .alert.error {
      display: block;
      background: rgba(220, 53, 69, 0.08);
      border-color: rgba(220, 53, 69, 0.25);
      color: #b02a37;
    }

    .alert i {
      margin-right: 8px;
    }
  </style>
</head>

<body>
  <div id="header-placeholder"></div>

  <section class="wrap">
    <div class="container">

      <div class="grid">
        <!-- LEFT: Profile only -->
        <div class="card">
          <div style="display:flex; justify-content:space-between; gap:14px; flex-wrap:wrap; align-items:flex-start;">
            <div>
              <h2 style="margin:0;">My Profile</h2>
              <p style="margin:6px 0 0; color:#555;">Your account details.</p>
            </div>

            <div class="badge">
              <i class="fa-solid fa-user"></i><span>User</span>
            </div>
          </div>

          <div class="user-meta">
            <div class="meta-row">
              <div class="meta-icon"><i class="fa-solid fa-id-card"></i></div>
              <div>
                <strong>Full Name</strong>
                <span id="user-name">—</span>
              </div>
            </div>

            <div class="meta-row">
              <div class="meta-icon"><i class="fa-solid fa-envelope"></i></div>
              <div>
                <strong>Email</strong>
                <span id="user-email">—</span>
              </div>
            </div>

            <div class="meta-row">
              <div class="meta-icon"><i class="fa-solid fa-shield"></i></div>
              <div>
                <strong>Role</strong>
                <span id="user-role">—</span>
              </div>
            </div>
          </div>

          <div class="actions">
            <a class="btn btn-outline" href="index.html">
              <i class="fa-solid fa-house" style="margin-right:8px;"></i> Home
            </a>

            <button class="btn" id="logout-btn" type="button">
              <i class="fa-solid fa-arrow-right-from-bracket" style="margin-right:8px;"></i> Logout
            </button>
          </div>

          <p class="small">If you changed role in database, logout & login again to refresh.</p>
        </div>

        <!-- RIGHT: Testimonial link + info -->
        <div class="card">
          <h3 style="margin:0 0 10px;">Testimonials</h3>
          <p style="margin:0; color:#555;">Submit your testimonial and track approval status.</p>

          <div class="actions" style="margin-top:12px;">
            <a class="btn" href="add-testimonial.html">
              <i class="fa-solid fa-comment-dots" style="margin-right:8px;"></i> Add Testimonial
            </a>
            <button class="btn btn-outline" id="refreshMyTestimonialsBtn" type="button">
              <i class="fa-solid fa-rotate" style="margin-right:8px;"></i> Refresh
            </button>
          </div>

          <div id="myTestimonialsAlert" class="alert"></div>
          <div id="myTestimonialsStatus" class="small" style="margin-top:10px;">Loading your testimonials...</div>

          <div id="myTestimonialsGrid" class="manager-grid"></div>
        </div>
      </div>

    </div>
  </section>

<footer>
  <div class="container">
    <div class="footer-container">

      <div class="footer-col">
        <h4>Sara Wellness</h4>
        <p>
          Holistic approaches to wellness that integrate physical health with mental wellbeing
          for a balanced, fulfilling life.
        </p>
      </div>

      <div class="footer-col">
        <h4>Services</h4>
        <ul>
          <li><a href="weight-loss.html">Weight Loss</a></li>
          <li><a href="hair-loss.html">Hair Loss</a></li>
          <li><a href="skin-care.html">Skin Care</a></li>
          <li><a href="stress-management.html">Stress Management</a></li>
          <li><a href="pain-relief.html">Pain Relief</a></li>
          <li><a href="personal-problems.html">Personal Problems</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h4>Quick Links</h4>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="services.html">Services</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="testimonials.html">Testimonials</a></li>
          <li><a href="blog.html">Blog</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h4>Newsletter</h4>
        <p>Subscribe to our newsletter for wellness tips and updates.</p>
        <form onsubmit="event.preventDefault(); alert('Thanks for subscribing!');">
          <input type="email" placeholder="Your Email" required>
          <button type="submit" class="btn">Subscribe</button>
        </form>
      </div>

    </div>

    <div class="copyright">
      <p>&copy; 2023 Sara Wellness. All rights reserved.</p>
    </div>
  </div>
</footer>


  <script>
    const API_BASE = "https://backend-sarawellness.onrender.com";

    function getToken() { return localStorage.getItem("token"); }
    function getUser() { try { return JSON.parse(localStorage.getItem("user") || "null"); } catch { return null; } }
    function isUserRole() {
      const u = getUser();
      return !!getToken() && (u?.role || "").toLowerCase() === "user";
    }

    function escapeHtml(str) {
      return String(str || "")
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    function resolveImageUrl(img) {
      if (!img) return "";
      if (typeof img === "string" && (img.startsWith("http://") || img.startsWith("https://"))) return img;
      if (typeof img === "string") return img.startsWith("/") ? `${API_BASE}${img}` : `${API_BASE}/${img}`;
      return "";
    }

    function formatDate(dateStr) {
      if (!dateStr) return "";
      const d = new Date(dateStr);
      if (isNaN(d.getTime())) return "";
      return d.toLocaleDateString(undefined, { year: "numeric", month: "short", day: "numeric" });
    }

    function stars(rating) {
      const r = Math.max(1, Math.min(5, Number(rating || 0)));
      let out = "";
      for (let i = 1; i <= 5; i++) out += i <= r ? "★" : "☆";
      return out;
    }

    function showAlert(el, type, message) {
      el.className = `alert ${type}`;
      el.innerHTML = type === "success"
        ? `<i class="fa-solid fa-circle-check"></i>${message}`
        : `<i class="fa-solid fa-triangle-exclamation"></i>${message}`;
      el.style.display = "block";
    }

    function hideAlert(el) {
      el.style.display = "none";
      el.innerHTML = "";
      el.className = "alert";
    }

    // ---- Guard + Profile render
    (function initProfile() {
      const token = getToken();
      const user = getUser();

      if (!token || !user) {
        window.location.href = "login.html";
        return;
      }

      // If admin, send to dashboard
      if ((user.role || "").toLowerCase() === "admin") {
        window.location.href = "dashboard.html";
        return;
      }

      document.getElementById("user-name").textContent = user.name || "—";
      document.getElementById("user-email").textContent = user.email || "—";
      document.getElementById("user-role").textContent = user.role || "—";

      document.getElementById("logout-btn").addEventListener("click", () => {
        localStorage.removeItem("token");
        localStorage.removeItem("user");
        window.location.href = "login.html";
      });
    })();

    // ---- My Testimonials
    const myGrid = document.getElementById("myTestimonialsGrid");
    const myStatus = document.getElementById("myTestimonialsStatus");
    const myAlert = document.getElementById("myTestimonialsAlert");
    const refreshBtn = document.getElementById("refreshMyTestimonialsBtn");

    function renderMyTestimonials(list) {
      myGrid.innerHTML = "";

      if (!list.length) {
        myStatus.textContent = "No testimonials submitted yet.";
        return;
      }

      myStatus.textContent = `${list.length} testimonial(s).`;

      list.forEach(t => {
        const imgUrl = resolveImageUrl(t.image);
        const approved = !!t.approved;

        const card = document.createElement("div");
        card.className = "manager-card";

        card.innerHTML = `
          <div class="manager-img">
            ${imgUrl ? `<img src="${escapeHtml(imgUrl)}" alt="testimonial">`
            : `<i class="fa-solid fa-user" style="font-size:34px; color:#2E8B57;"></i>`}
          </div>

          <div class="manager-body">
            <div style="display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap; align-items:center;">
              <div class="pill">${escapeHtml(t.service || "Service")}</div>
              <div class="pill ${approved ? "" : "pending"}">${approved ? "APPROVED" : "PENDING"}</div>
            </div>

            <div style="font-weight:900; color:#f5a524;">${stars(t.rating)} <span style="color:#666;">(${t.rating || ""})</span></div>

            <div class="truncate-3" style="color:#444; font-size:13px; line-height:1.55;">
              ${escapeHtml(t.content || "")}
            </div>

            <div style="font-size:12px; color:#777;">
              ${t.createdAt ? "Created: " + escapeHtml(formatDate(t.createdAt)) : ""}
            </div>
          </div>
        `;

        myGrid.appendChild(card);
      });
    }

    async function fetchMyTestimonials() {
      hideAlert(myAlert);
      myStatus.textContent = "Loading your testimonials...";
      myGrid.innerHTML = "";

      const token = getToken();
      const user = getUser();
      if (!token || !user) {
        window.location.href = "login.html";
        return;
      }

      // ✅ Requires backend endpoint:
      // GET /api/testimonials/me
      // (returns all testimonials created by this user)
      try {
        const res = await fetch(`${API_BASE}/api/testimonials/me`, {
          headers: { Authorization: `Bearer ${token}` }
        });

        let data = {};
        try { data = await res.json(); } catch { }

        if (!res.ok) {
          showAlert(myAlert, "error", data?.message || `Failed to load (HTTP ${res.status})`);
          myStatus.textContent = "Unable to load.";
          return;
        }

        const list = Array.isArray(data) ? data : (data.data || data.testimonials || []);
        list.sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0));
        renderMyTestimonials(list);

      } catch {
        showAlert(myAlert, "error", "Server not reachable.");
        myStatus.textContent = "Unable to load.";
      }
    }

    refreshBtn.addEventListener("click", fetchMyTestimonials);
    fetchMyTestimonials();
  </script>

  <!-- Header loader (active + hamburger + role link) -->
  <script>
    fetch("header.html")
      .then(res => res.text())
      .then(html => {
        document.getElementById("header-placeholder").innerHTML = html;

        function getToken() { return localStorage.getItem("token"); }
        function getUser() { try { return JSON.parse(localStorage.getItem("user") || "null"); } catch { return null; } }
        function isAdmin() { const u = getUser(); return (u?.role || "").toLowerCase() === "admin"; }

        const token = getToken();
        const guest1 = document.getElementById("nav-auth-guest");
        const guest2 = document.getElementById("nav-auth-guest-2");
        const userNav = document.getElementById("nav-auth-user");
        const roleLi = document.getElementById("nav-role-link");

        if (token) {
          if (guest1) guest1.style.display = "none";
          if (guest2) guest2.style.display = "none";
          if (userNav) userNav.style.display = "inline-block";

          if (roleLi) {
            roleLi.style.display = "inline-block";
            roleLi.innerHTML = isAdmin()
              ? `<a href="dashboard.html" data-nav="dashboard"><i class="fa-solid fa-gauge" style="margin-right:8px;"></i>Dashboard</a>`
              : `<a href="profile.html" data-nav="profile"><i class="fa-solid fa-user" style="margin-right:8px;"></i>Profile</a>`;
          }
        } else {
          if (guest1) guest1.style.display = "inline-block";
          if (guest2) guest2.style.display = "inline-block";
          if (userNav) userNav.style.display = "none";
          if (roleLi) roleLi.style.display = "none";
        }

        const logoutLink = document.getElementById("logout-link");
        if (logoutLink) {
          logoutLink.addEventListener("click", (e) => {
            e.preventDefault();
            localStorage.removeItem("token");
            localStorage.removeItem("user");
            window.location.href = "login.html";
          });
        }

        const current = (location.pathname.split("/").pop() || "index.html").toLowerCase();
        const map = { "profile.html": "profile" };
        const key = map[current];
        if (key) {
          const activeLink = document.querySelector(`.sw-nav a[data-nav="${key}"]`);
          if (activeLink) activeLink.classList.add("active");
        }

        const burger = document.getElementById("sw-burger");
        const nav = document.getElementById("sw-nav");

        if (burger && nav) {
          const closeMenu = () => {
            nav.classList.remove("open");
            burger.classList.remove("is-open");
            burger.setAttribute("aria-expanded", "false");
          };

          burger.addEventListener("click", () => {
            const open = nav.classList.toggle("open");
            burger.classList.toggle("is-open", open);
            burger.setAttribute("aria-expanded", open ? "true" : "false");
          });

          nav.addEventListener("click", (e) => {
            const a = e.target.closest("a");
            if (a && window.innerWidth <= 900) closeMenu();
          });

          window.addEventListener("resize", () => {
            if (window.innerWidth > 900) closeMenu();
          });

          document.addEventListener("click", (e) => {
            if (window.innerWidth > 900) return;
            if (!nav.classList.contains("open")) return;
            const inside = e.target.closest("#sw-nav") || e.target.closest("#sw-burger");
            if (!inside) closeMenu();
          });
        }
      });
  </script>
  <!-- ✅ Single-file reusable chatbot (NO fetch, NO extra files)
     Paste this near the END of <body> in ANY page.
     Requirements: FontAwesome link in <head> (optional, icons will fallback if missing)
-->

<style>
  /* ===== Sara Wellness Reusable Chatbot (Single-file) ===== */
  #sw-chatbot{position:fixed;bottom:30px;right:30px;z-index:9999}
  #sw-chatbot .sw-chatbot-btn{
    width:60px;height:60px;border-radius:50%;
    background:linear-gradient(135deg,#DC143C,#4B0082);
    display:flex;align-items:center;justify-content:center;
    color:#fff;font-size:1.5rem;cursor:pointer;
    box-shadow:0 5px 15px rgba(0,0,0,.2);
    transition:transform .3s ease;animation:swPulse 2s infinite;
    user-select:none;
  }
  #sw-chatbot .sw-chatbot-btn:hover{transform:scale(1.1)}
  @keyframes swPulse{
    0%{box-shadow:0 0 0 0 rgba(220,20,60,.7)}
    70%{box-shadow:0 0 0 15px rgba(220,20,60,0)}
    100%{box-shadow:0 0 0 0 rgba(220,20,60,0)}
  }

  #sw-chatbot .sw-chatbot-window{
    position:absolute;bottom:70px;right:0;
    width:350px;height:450px;background:#fff;border-radius:15px;
    box-shadow:0 5px 25px rgba(0,0,0,.2);
    display:none;flex-direction:column;overflow:hidden;
    border:2px solid #DC143C;
  }
  #sw-chatbot .sw-chatbot-window.show{display:flex}

  #sw-chatbot .sw-chatbot-header{
    background:linear-gradient(135deg,#DC143C,#4B0082);
    color:#fff;padding:15px;display:flex;align-items:center;justify-content:space-between
  }
  #sw-chatbot .sw-chatbot-header h3{font-size:1rem;margin:0}
  #sw-chatbot .sw-close{cursor:pointer;display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;border-radius:50%}
  #sw-chatbot .sw-close:hover{background:rgba(255,255,255,.15)}

  #sw-chatbot .sw-messages{
    flex:1;padding:15px;overflow-y:auto;display:flex;flex-direction:column;gap:10px
  }
  #sw-chatbot .sw-message{
    max-width:80%;padding:10px 15px;border-radius:20px;line-height:1.4;font-size:.95rem;white-space:pre-wrap
  }
  #sw-chatbot .sw-bot{background:#f1f1f1;align-self:flex-start;border-bottom-left-radius:6px;color:#343a40}
  #sw-chatbot .sw-user{background:#DC143C;color:#fff;align-self:flex-end;border-bottom-right-radius:6px}

  #sw-chatbot .sw-input{
    display:flex;gap:10px;padding:10px;border-top:1px solid #ddd;background:#fff
  }
  #sw-chatbot .sw-input input{
    flex:1;padding:10px;border:1px solid #ddd;border-radius:20px;outline:none
  }
  #sw-chatbot .sw-input button{
    width:40px;height:40px;border:none;border-radius:50%;
    background:#DC143C;color:#fff;cursor:pointer;flex:0 0 auto
  }

  @media (max-width:768px){
    #sw-chatbot{bottom:20px;right:20px}
    #sw-chatbot .sw-chatbot-window{width:300px;height:400px}
  }
</style>

<div id="sw-chatbot" aria-live="polite">
  <div class="sw-chatbot-btn" id="sw-chatbot-btn" aria-label="Open chat" role="button" tabindex="0">
    <i class="fas fa-comment-medical" aria-hidden="true"></i>
  </div>

  <div class="sw-chatbot-window" id="sw-chatbot-window" aria-hidden="true">
    <div class="sw-chatbot-header">
      <h3>Sara Wellness Assistant</h3>
      <span class="sw-close" id="sw-chatbot-close" aria-label="Close chat" role="button" tabindex="0">
        <i class="fas fa-times" aria-hidden="true"></i>
      </span>
    </div>

    <div class="sw-messages" id="sw-chatbot-messages">
      <div class="sw-message sw-bot">
        Hello! I'm Sara, your wellness assistant. You can ask me anything about our services: weight loss, hair loss, skin care, stress management, pain relief, or personal problems.
      </div>
    </div>

    <div class="sw-input">
      <input type="text" id="sw-user-input" placeholder="Type your question here..." autocomplete="off" />
      <button id="sw-send-btn" aria-label="Send message">
        <i class="fas fa-paper-plane" aria-hidden="true"></i>
      </button>
    </div>
  </div>
</div>

<script>
  (function () {
    // Avoid double-init if pasted twice
    if (window.__SW_CHATBOT_INIT__) return;
    window.__SW_CHATBOT_INIT__ = true;

    const btn = document.getElementById("sw-chatbot-btn");
    const win = document.getElementById("sw-chatbot-window");
    const closeBtn = document.getElementById("sw-chatbot-close");
    const input = document.getElementById("sw-user-input");
    const sendBtn = document.getElementById("sw-send-btn");
    const messages = document.getElementById("sw-chatbot-messages");

    function openChat() {
      win.classList.add("show");
      win.setAttribute("aria-hidden", "false");
      setTimeout(() => input && input.focus(), 50);
    }

    function closeChat() {
      win.classList.remove("show");
      win.setAttribute("aria-hidden", "true");
    }

    function addMessage(text, sender) {
      const el = document.createElement("div");
      el.className = "sw-message " + (sender === "user" ? "sw-user" : "sw-bot");
      el.textContent = text;
      messages.appendChild(el);
      messages.scrollTop = messages.scrollHeight;
    }

    function generateResponse(message) {
      const msg = String(message || "").toLowerCase();

      // Weight loss
      if (msg.includes("weight") || msg.includes("diet") || msg.includes("obese") || msg.includes("fat")) {
        return "Our weight loss program includes personalized diet plans, exercise routines, and lifestyle modifications. We focus on sustainable weight loss rather than quick fixes.";
      }

      // Hair loss
      if (msg.includes("hair") || msg.includes("bald") || msg.includes("scalp")) {
        return "We offer comprehensive hair loss treatments including scalp therapies, nutritional guidance, and natural remedies to promote hair growth and reduce hair fall.";
      }

      // Skin care
      if (msg.includes("skin") || msg.includes("acne") || msg.includes("pimple") || msg.includes("glow")) {
        return "Our skin care treatments address concerns like acne, aging, pigmentation, and dryness. We use a combination of advanced treatments and natural approaches.";
      }

      // Stress
      if (msg.includes("stress") || msg.includes("anxiety") || msg.includes("tension") || msg.includes("worry")) {
        return "Our stress management program includes counseling, relaxation techniques, mindfulness practices, and lifestyle adjustments to help you manage stress effectively.";
      }

      // Pain relief (fixed your old typo: imcludes -> includes)
      if (
        msg.includes("pain") ||
        msg.includes("joint") ||
        msg.includes("joints") ||
        msg.includes("sprain") ||
        msg.includes("shoulder") ||
        msg.includes("muscle") ||
        msg.includes("stomach ache")
      ) {
        return "Our pain relief service offers natural and holistic approaches to manage and relieve chronic pain, improving your quality of life through proven techniques.";
      }

      // Personal problems / general issues
      if (msg.includes("personal") || msg.includes("problem") || msg.includes("issue")) {
        return "We provide discreet support for sensitive personal concerns in a safe, confidential environment. For private guidance, please book a consultation via our contact page.";
      }

      // Appointment
      if (msg.includes("appointment") || msg.includes("schedule") || msg.includes("book") || msg.includes("meet")) {
        return "You can book an appointment by calling +977-15225050 or by using our contact page. Our staff will get back to you soon.";
      }

      // Price
      if (msg.includes("price") || msg.includes("cost") || msg.includes("fee") || msg.includes("charge")) {
        return "Pricing depends on the treatment plan. Please contact us for specific packages and consultation details.";
      }

      // Greetings
      if (msg.includes("hello") || msg.includes("hi") || msg.includes("hey") || msg.includes("namaste")) {
        return "Hello! How can I help you with your wellness journey today?";
      }

      if (msg.includes("thank")) {
        return "You're welcome! Is there anything else you'd like to know about our services?";
      }

      return "Thank you for your question. I can share info about our wellness services. For more specific help, please contact us directly.";
    }

    function sendMessage() {
      const text = (input.value || "").trim();
      if (!text) return;

      addMessage(text, "user");
      input.value = "";

      setTimeout(() => addMessage(generateResponse(text), "bot"), 600);
    }

    // Click handlers
    btn.addEventListener("click", openChat);
    closeBtn.addEventListener("click", closeChat);
    sendBtn.addEventListener("click", sendMessage);

    // Enter to send
    input.addEventListener("keydown", (e) => {
      if (e.key === "Enter") sendMessage();
      if (e.key === "Escape") closeChat();
    });

    // Allow keyboard access on open/close icons
    btn.addEventListener("keydown", (e) => { if (e.key === "Enter") openChat(); });
    closeBtn.addEventListener("keydown", (e) => { if (e.key === "Enter") closeChat(); });

    // Optional: ESC anywhere closes if open
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && win.classList.contains("show")) closeChat();
    });
  })();
</script>

</body>

</html>
